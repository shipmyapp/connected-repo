# Packages Guidelines

## Architecture

### NO Barrel Exports
- NEVER create `index.ts` re-exporting everything
- Direct imports: `import { Button } from '@connected-repo/ui-mui/form/Button'`
- Enables tree-shaking

### Tree-Shaking
- `"sideEffects": false` in package.json
- Only imported code bundled
- Direct file exports via `exports` field

### Internal Imports
- **Within package**: Relative imports (`./Component`, `../folder/Component`)
- **Between packages**: Package exports (`@connected-repo/package/path/Component`)

Example:
```typescript
// ‚úÖ Internal (within ui-mui)
import { NumLockAlert } from "../feedback/NumLockAlert";

// ‚úÖ External (from other packages)
import { RhfFormProvider } from '@connected-repo/ui-mui/rhf-form/FormProvider';

// ‚ùå Wrong - package alias internally
import { NumLockAlert } from "@ui-mui/feedback/NumLockAlert";
```

## Available Packages

### @connected-repo/typescript-config
Shared TypeScript configs

**Configs**: `base.json`, `library.json`, `react-library.json`, `vite.json`

```json
// For libraries
{ "extends": "@connected-repo/typescript-config/library.json" }

// For Vite apps
{ "extends": "@connected-repo/typescript-config/vite.json" }
```

### @connected-repo/zod-schemas
Zod validation schemas

**Pattern**: Each entity has `MandatoryZod`, `OptionalZod`, `AutoGeneratedZod`, `CreateInputZod`, `UpdateInputZod`, `SelectAllZod`

```typescript
import { userCreateInputZod } from '@connected-repo/zod-schemas/user.zod'
import { zString, zPrice } from '@connected-repo/zod-schemas/zod_utils'
```

üìñ See [zod-schemas/AGENTS.md](./zod-schemas/AGENTS.md)

### @connected-repo/ui-mui
Material-UI components + RHF wrappers

```typescript
import { Button } from '@connected-repo/ui-mui/form/Button'
import { RhfTextField } from '@connected-repo/ui-mui/rhf-form/RhfTextField'
```

üìñ See [ui-mui/AGENTS.md](./ui-mui/AGENTS.md)

## Import Rules
```typescript
// ‚úÖ Direct imports
import { Button } from '@connected-repo/ui-mui/form/Button'
import { userCreateInputZod } from '@connected-repo/zod-schemas/user.zod'

// ‚ùå Package root (won't work)
import { Button } from '@connected-repo/ui-mui'
```

## Bundle Impact
```typescript
// With barrel: ~500KB (bundles everything)
import { Button } from '@repo/ui'

// Direct: ~5KB (bundles only Button)
import { Button } from '@repo/ui/form/Button'
```

## Adding Package

1. Create: `packages/my-package/`
2. Add package.json: `"sideEffects": false`, configure `exports`
3. Create tsconfig.json extending base
4. Add to root workspaces

```json
{
  "name": "@connected-repo/my-package",
  "type": "module",
  "sideEffects": false,
  "exports": {
    "./*": {
      "types": "./src/*.ts",
      "import": "./dist/*.js"
    }
  }
}
```

## Troubleshooting
- **"Cannot find module"**: Run `yarn build` in package, verify exports, restart TS server
- **Tree-shaking not working**: Check `"sideEffects": false`, use direct imports, verify `"type": "module"`
